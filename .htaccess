# AllowOverride All

# redirect error to error page
ErrorDocument 401 /TP1/src/views/Error.php?error=401
ErrorDocument 403 /TP1/src/views/Error.php?error=403
ErrorDocument 404 /TP1/src/views/Error.php?error=404
ErrorDocument 500 /TP1/src/views/Error.php?error=500

# Change default directory page
# Options -Indexes
# DirectoryIndex src/views/Index.php /Index
 

# remove the php extention in the url
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php




# Caching module
<ifModule mod_headers.c>
    # One month for most static assets
    <filesMatch ".(css|jpg|jpeg|png|gif|js|ico)$">
        Header set Cache-Control "max-age=2628000, public"
    </filesMatch>
    # WEEK
    <FilesMatch ".(js|css|swf)$">
        Header set Cache-Control "max-age=604800"
    </FilesMatch>
    # 45 MIN
    <FilesMatch ".(html|htm|txt)$">
        Header set Cache-Control "max-age=2700"
    </FilesMatch>
</ifModule>

# GZIP Compression
<ifModule mod_gzip.c>
    mod_gzip_on Yes
    mod_gzip_dechunk Yes
    mod_gzip_item_include file .(html?|txt|css|js|php|pl)$
    mod_gzip_item_include handler ^cgi-script$
    mod_gzip_item_include mime ^text/.*
    mod_gzip_item_include mime ^application/x-javascript.*
    mod_gzip_item_exclude mime ^image/.*
    mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</ifModule>

# IF GZIP isnt supported, backup
<IfModule mod_deflate.c>
    # Compress text, HTML, JavaScript, CSS, XML
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
    # The following lines are to avoid bugs with some browsers
    BrowserMatch ^Mozilla/4 gzip-only-text/html
    BrowserMatch ^Mozilla/4.0[678] no-gzip
    BrowserMatch bMSIE !no-gzip !gzip-only-text/html
    BrowserMatch bMSI[E] !no-gzip !gzip-only-text/html
    # Do not cache if these files are already cached
    SetEnvIfNoCase Request_URI .(?:gif|jpe?g|png)$ no-gzip
    # Proxies must give the right content
    # Header append Vary User-Agent env=!dont-vary
    Header append Vary User-Agent
</IfModule>

# Crawling & Indexing
<FilesMatch ".(docx|pdf)$">
    Header add X-robots-tag "noindex, noarchive, nosnippet"
</FilesMatch>